<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="675px" preserveAspectRatio="none" style="width:1260px;height:675px;background:#FFFFFF;" version="1.1" viewBox="0 0 1260 675" width="1260px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="584.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="20.5" y="46.2969"/><rect fill="#FFFFFF" height="554.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="178.5" y="67.4297"/><rect fill="#FFFFFF" height="454.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="361.5" y="138.6953"/><rect fill="#FFFFFF" height="353.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="544.5" y="209.9609"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.5" y="298.2266"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="766.5" y="445.625"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="873.5" y="239.0938"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="988" y="357.3594"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="988" y="504.7578"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1097" y="386.4922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="25" x2="25" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="183" x2="183" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="366.5" x2="366.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="549" x2="549" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="676.5" x2="676.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="771.5" x2="771.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="878.5" x2="878.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="992.5" x2="992.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1101.5" x2="1101.5" y1="36.2969" y2="640.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1201.5" x2="1201.5" y1="36.2969" y2="640.1563"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="12" y="24.9951">SPA</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="12" y="659.1514">SPA</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="149" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="156" y="24.9951">MPT API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="149" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="156" y="659.1514">MPT API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="296.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="303.5" y="24.9951">PlanningController</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="296.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="303.5" y="659.1514">PlanningController</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="488" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="495" y="24.9951">PlanningService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="488" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="495" y="659.1514">PlanningService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="646.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="653.5" y="24.9951">MP API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="646.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="653.5" y="659.1514">MP API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="716.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="723.5" y="24.9951">PlanningRepo</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="716.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="723.5" y="659.1514">PlanningRepo</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="836.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="843.5" y="24.9951">TaskRepo</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="836.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="843.5" y="659.1514">TaskRepo</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="930.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="937.5" y="24.9951">PlanningMapper</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="930.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="937.5" y="659.1514">PlanningMapper</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="1065.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1072.5" y="24.9951">Planning</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="1065.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1072.5" y="659.1514">Planning</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="1148.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="1155.5" y="24.9951">PlanningTask</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="1148.5" y="639.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="1155.5" y="659.1514">PlanningTask</text><rect fill="#FFFFFF" height="584.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="20.5" y="46.2969"/><rect fill="#FFFFFF" height="554.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="178.5" y="67.4297"/><rect fill="#FFFFFF" height="454.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="361.5" y="138.6953"/><rect fill="#FFFFFF" height="353.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="544.5" y="209.9609"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.5" y="298.2266"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="766.5" y="445.625"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="873.5" y="239.0938"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="988" y="357.3594"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="988" y="504.7578"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1097" y="386.4922"/><polygon fill="#181818" points="166.5,63.4297,176.5,67.4297,166.5,71.4297,170.5,67.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="172.5" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="37.5" y="62.3638">POST(/api/planning/)</text><line style="stroke:#181818;stroke-width:1.0;" x1="188.5" x2="230.5" y1="96.5625" y2="96.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="230.5" x2="230.5" y1="96.5625" y2="109.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="189.5" x2="230.5" y1="109.5625" y2="109.5625"/><polygon fill="#181818" points="199.5,105.5625,189.5,109.5625,199.5,113.5625,195.5,109.5625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="195.5" y="91.4966">auth middleware</text><polygon fill="#181818" points="349.5,134.6953,359.5,138.6953,349.5,142.6953,353.5,138.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="188.5" x2="355.5" y1="138.6953" y2="138.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="195.5" y="133.6294">AddAsync(tasks, userId)</text><line style="stroke:#181818;stroke-width:1.0;" x1="371.5" x2="413.5" y1="167.8281" y2="167.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="413.5" x2="413.5" y1="167.8281" y2="180.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="372.5" x2="413.5" y1="180.8281" y2="180.8281"/><polygon fill="#181818" points="382.5,176.8281,372.5,180.8281,382.5,184.8281,378.5,180.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="378.5" y="162.7622">permissions middleware</text><polygon fill="#181818" points="532.5,205.9609,542.5,209.9609,532.5,213.9609,536.5,209.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="371.5" x2="538.5" y1="209.9609" y2="209.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="378.5" y="204.895">AddAsync(tasks, userId)</text><polygon fill="#181818" points="861.5,235.0938,871.5,239.0938,861.5,243.0938,865.5,239.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.5" x2="867.5" y1="239.0938" y2="239.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="561.5" y="234.0278">GetByIdsAsync(taskIds)</text><polygon fill="#181818" points="659.5,294.2266,669.5,298.2266,659.5,302.2266,663.5,298.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.5" x2="665.5" y1="298.2266" y2="298.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="561.5" y="293.1606">planning(tasks)</text><polygon fill="#181818" points="976,353.3594,986,357.3594,976,361.3594,980,357.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.5" x2="982" y1="357.3594" y2="357.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="561.5" y="352.2935">toDomain(userId, 0)</text><polygon fill="#181818" points="1085,382.4922,1095,386.4922,1085,390.4922,1089,386.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="1091" y1="386.4922" y2="386.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="1005" y="381.4263">create</text><polygon fill="#181818" points="754.5,441.625,764.5,445.625,754.5,449.625,758.5,445.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.5" x2="760.5" y1="445.625" y2="445.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="561.5" y="440.5591">AddAsync(planning)</text><polygon fill="#181818" points="976,500.7578,986,504.7578,976,508.7578,980,504.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.5" x2="982" y1="504.7578" y2="504.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="561.5" y="499.6919">toDTO(Planning)</text><polygon fill="#181818" points="382.5,559.8906,372.5,563.8906,382.5,567.8906,378.5,563.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="376.5" x2="548.5" y1="563.8906" y2="563.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="388.5" y="558.8247">PlanningDTO</text><polygon fill="#181818" points="199.5,589.0234,189.5,593.0234,199.5,597.0234,195.5,593.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="365.5" y1="593.0234" y2="593.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="205.5" y="587.9575">status code 201</text><polygon fill="#181818" points="41.5,618.1563,31.5,622.1563,41.5,626.1563,37.5,622.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="35.5" x2="182.5" y1="622.1563" y2="622.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="47.5" y="617.0903">success</text><!--MD5=[7b72929a74c1743a69268188378fd2ab]
@startuml
participant SPA
participant "MPT API" as API
participant "MP API" as API2
participant "PlanningController" as Ctrl
participant "PlanningService" as Srv
participant "MGI API" as API2
participant "PlanningRepo" as Repo
participant "TaskRepo" as tr
participant "PlanningMapper" as Map
participant "Planning" as Planning
participant "PlanningTask" as pt

activate SPA
SPA -> API: POST(/api/planning/)
activate API

API -> API: auth middleware 
API -> Ctrl: AddAsync(tasks, userId)
activate Ctrl

Ctrl -> Ctrl: permissions middleware 
Ctrl -> Srv: AddAsync(tasks, userId)
activate Srv

Srv -> tr: GetByIdsAsync(taskIds)
activate tr
deactivate tr

Srv -> API2 : planning(tasks)
activate API2
deactivate API2

Srv -> Map : toDomain(userId, 0)
activate Map
Map -> Planning: create
activate Planning
deactivate Planning
deactivate Map

Srv -> Repo: AddAsync(planning)
activate Repo
deactivate Repo

Srv -> Map: toDTO(Planning)
activate Map
deactivate Map

Srv - -> Ctrl: PlanningDTO
deactivate Srv

Ctrl - -> API: status code 201
deactivate Ctrl

API - -> SPA: success
deactivate API


@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>